package filter

import (
	"testing"

	"github.com/kubetrail/signal/pkg/util"
)

// Design filters in Matlab and export them to workspace as objects.
// Then create a signal and filter it using these filters.
// Finally encode all these variables and objects as JSON strings.
var (
	// finite impulse response filter exported from Matlab
	jsonDffir = `
{"Arithmetic":"double","Numerator":[0.00697387274154911,0.027899124204610777,0.062773539710178169,0.097647955215745583,0.11246843769288579,0.097647955215745583,0.062773539710178169,0.027899124204610777,0.00697387274154911],"FilterStructure":"Direct-Form FIR","States":[0,0,0,0,0,0,0,0],"NumSamplesProcessed":0,"PersistentMemory":false,"RateChangeFactor":[1,1]}
`
	// infinite impulse response filter exported from Matlab
	jsonDf2sos = `
{"OptimizeScaleValues":true,"Arithmetic":"double","sosMatrix":[[1,2,1,1,-1.9399079934360748,0.96638413588871874],[1,2,1,1,-1.8781519589505673,0.90378524618952],[1,2,1,1,-1.8239230885575546,0.84881625239765046],[1,2,1,1,-1.7784485176020812,0.80272103797729988],[1,2,1,1,-1.7425156378437257,0.76629774112368232],[1,2,1,1,-1.7165989981935739,0.7400273874594675],[1,2,1,1,-1.7009635843173447,0.72417857921273543],[1,1,0,1,-0.84786950003245831,0]],"ScaleValues":[0.0066190356131609618,0.0064083218097381808,0.0062232909600239833,0.0060681300938045767,0.0059455258199891418,0.0058570973164733808,0.0058037487238476243,0.076065249983770788,1],"FilterStructure":"Direct-Form II, Second-Order Sections","States":[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],"NumSamplesProcessed":0,"PersistentMemory":false,"RateChangeFactor":[1,1]}
`

	// raw signal
	jsonRawSignal = `
[0.5376671395461,1.8338850145950865,-2.2588468610036481,0.86217332036812055,0.31876523985898081,-1.3076882963052734,-0.43359202230568356,0.34262446653864992,3.5783969397257605,2.7694370298848772,-1.3498869401565212,3.0349234663318545,0.72540422494610557,-0.063054873189656191,0.71474290382609584,-0.20496605829977463,-0.12414434821631191,1.4896976077854649,1.4090344898004792,1.4171924134296139,0.6714971336080805,-1.2074869226850378,0.71723865132883846,1.6302352891647292,0.48889377031178938,1.0346930099178602,0.7268851333832379,-0.30344092478601592,0.29387146709665807,-0.78728280375863757,0.8883956317576418,-1.1470701069691505,-1.0688704581680317,-0.80949869442487554,-2.9442841619948963,1.4383802928150984,0.32519053945619786,-0.75492831916970338,1.3702985400952279,-1.711516418853698,-0.10224244608549089,-0.24144704160735794,0.3192067391655018,0.31285859663742843,-0.86487991732445646,-0.030051296196268559,-0.1648790192090383,0.62770728752872651,1.093265669039484,1.1092732976143975,-0.8636528219887144,0.077359091130424926,-1.2141170436154092,-1.1135007414867644,-0.0068493281033480645,1.5326303082847499,-0.76966591375368187,0.37137881276005774,-0.22558440227125193,1.1173561388144666,-1.0890642950522358,0.032557464164973467,0.55252702111222374,1.1006102178808663,1.544211895503951,0.085931133175425459,-1.4915903106376094,-0.74230183725985666,-1.0615817333199864,2.3504572240020423,-0.61560188146689432,0.74807678370398512,-0.19241851058826356,0.88861042542072077,-0.76484923656787418,-1.4022689693387587,-1.4223759250914965,0.48819390985994066,-0.17737515661882522,-0.19605348780733281,1.4193101506425494,0.29158437398418252,0.19781105346436073,1.5876990899740593,-0.8044659563495471,0.69662441584960733,0.83508816507268191,-0.24371514037795219,0.21567008640374441,-1.1658439314820488,-1.1479527788985942,0.10487471601649398,0.72225403222500162,2.5854912526162415,-0.66689067070138552,0.1873310245789398,-0.0824944253709554,-1.9330229178509866,-0.43896615393477334,-1.7946788414551234,0.84037552975390539,-0.88803208232901032,0.10009283313932248,-0.54452892999054769,0.30352079464935428,-0.60032656213373414,0.48996532117394792,0.739363123604474,1.7118877829815546,-0.19412353575826538,-2.1383552694399386,-0.83958874733661359,1.3545943280046437,-1.0721552883842516,0.96095386974056685,0.12404980000319252,1.4366966227189388,-1.9608999993650327,-0.19769822597415024,-1.2078454852597988,2.9080080307293619,0.82521889422849093,1.3789719779166141,-1.0581802579873616,-0.46861558110062412,-0.27246940925018748,1.0984246178886228,-0.27787193278763889,0.7015414581632835,-2.0518162999111493,-0.35384999777443327,-0.82358652515685271,-1.5770570227992016,0.50797465090594562,0.28198406367055617,0.03347988224445142,-1.3336779434281061,1.1274922783415902,0.35017941060331165,-0.2990660303329824,0.022889792751629775,-0.26199543496609196,-1.7502123684467896,-0.28565097159532982,-0.83136651156762431,-0.97920630516730212,-1.1564016556640022,-0.53355710931598743,-2.0026357358830604,0.96422942263162748,0.52006010145545756,-0.020027851642538078,-0.034771086028482959,-0.79816358456414238,1.0186852821285755,-0.13321747950773469,-0.71453016378715839,1.3513857684266568,-0.2247710560525841,-0.58902903072080126,-0.29375359773541609,-0.8479262436379339,-1.1201283012437278,2.5259996921183094,1.6554975928873457,0.30753515923825192,-1.2571183593520534,-0.86546803055480381,-0.17653411423145093,0.791416061628634,-1.3320044213152473,-2.3298671558050761,-1.4490972928387393,0.33351083306580587,0.39135360443290096,0.45167941892823754,-0.13028465314572063,0.18368909586194213,-0.47615301661907383,0.862021611556922,-1.3616944708707543,0.45502955644433435,-0.848709379933659,-0.3348869389640477,0.55278334594455014,1.039090653504956,-1.1176386832652081,1.2606587091208963,0.66014314104697769,-0.067865553542687335,-0.19522119789875436,-0.21760635014319193,-0.30310762135174091,0.023045624425105282,0.0512903558487747,0.82606279021159545,1.5269766867333727,0.46691443568470004,-0.20971333838873671,0.62519035708762571,0.18322726300143696,-1.0297675435666211,0.94922183113102254,0.30706191914670344,0.13517494209945566,0.51524633552484855,0.26140632405538267,-0.94148577095543373,-0.16233767280382774,-0.14605463433152618,-0.53201137680882071,1.6821035946631788,-0.8757293461600173,-0.4838150501101211,-0.7120045490274225,-1.1742123314568162,-0.19223951753927476,-0.27407022993260222,1.5300725144240961,-0.24902474251371379,-1.0642134128893268,1.6034572981200441,1.2346791468907778,-0.22962645096318049,-1.506159703979719,-0.4446278164469854,-0.15594103572476894,0.27606825393153617,-0.2611636457764786,0.44342191290409133,0.39189420943244907,-1.2506789068264075,-0.947960922331432,-0.74110609394041149,-0.50781755027817366,-0.32057550660023926,0.012469041361617951,-3.0291773414041456,-0.45701464087158256,1.2424484063907384,-1.0667013989847496,0.93372816267123848,0.35032100135611161,-0.029005763708726321,0.18245216750598342,-1.565056014150725,-0.0845394798177242,1.6039463506028804,0.098347774640107952,0.041373613489614672,-0.73416911269673868,-0.030813730012319962,0.23234701262447677,0.426387557408945,-0.3728087417235042,-0.23645458375718628,2.0236908866030534,-2.2583539704961915,2.2294456804568989,0.33756370061310642,1.0000608195891247,-1.6641644749870603,-0.59003456420522149,-0.27806416376530935,0.42271569122047831,-1.6702006978504704,0.47163432641630271,-1.2128471996744594,0.066190048424611417,0.652355888661374,0.32705996717708752,1.0826335042367561,1.0060771108190514,-0.65090773659775258,0.25705615743396887,-0.944377806404219,-1.3217885213925638,0.9248259334937059,4.9849075250813308E-5,-0.0549189146094067,0.91112726565385982,0.59458369740905237,0.3502011738745352,1.2502512283049958,0.92978945855771566,0.23976325705858004,-0.69036110311122578,-0.651553641750281,1.19210187053127,-1.6118303886778107,-0.024461936635918457,-1.9488471768989009,1.0204980144526539,0.86171630239341845,0.0011620834835138535,-0.0708372131604802,-2.4862839207032787,0.58117232267592278,-2.1924349199659048,-2.3192803066433023,0.0799337102984397,-0.94848098357050525,0.41149062142337417,0.67697780568402954,0.85773254520535525,-0.6911591253829914,0.4493776231668507,0.10063335031507648,0.82606999846992324,0.53615707992591877,0.8978884259850759,-0.13193786792458084,-0.14720145615126731,1.0077734053054386,-2.12365546241575,-0.50458640551400991,-1.27059444980866,-0.38258480270764844,0.6486792620486207,0.82572714924175816,-1.0149436426801375,-0.47106991268316656,0.13702487413005029,-0.29186337575357335,0.30181855526100632,0.39993094295580212,-0.92996155894012944,-0.17683026592923176,-2.1320945991615345,1.1453617105184741,-0.62909076099415551,-1.2038499740022184,-0.25394468342281179,-1.4286468646320976,-0.020857617701600269,-0.56066499652818458,2.1777787091841541,1.1384653873295951,-2.496886503184502,0.44132693172760851,-1.3981378758110741,-0.25505517988080578,0.16440407331872858,0.74773402880812256,-0.27304694940290686,1.5763001465460751,-0.48093715177884522,0.32751212082968578,0.66473412062759452,0.085188592721160236,0.88095278538104782,0.32321313784759748,-0.7841461836640875,-1.8053733513860897,1.8585929485557051,-0.604530088774459,0.10335972231064805,0.56316695514597781,0.11359699673400174,-0.90472621279803178,-0.46771458245185632,-0.124889947223107,1.4789584915040301,-0.860815690006961,0.78466846728782147,0.30862313994852952,-0.23386004212915287,-1.056972745960131,-0.2841409546261639,-0.086690282459305129,-1.4693950744863571,0.19218224487078547,-0.82229327629017512,-0.09424058795972351,0.33621334095424027,-0.90465405924683717,-0.28825636120569642,0.35006275753417782,-1.8358591425043049,1.0359759082454805,2.4244611449393645,0.9594005094079755,-0.3157719950094085,0.42862267985939595,-1.0359847785133929,1.8778654604958582,0.94070440335213179,0.78734577993524624,-0.8758742619566724,0.31994913438233125,-0.5582942848509036,-0.3114294185468946,-0.5700099166421857,-1.0257336156287127,-0.90874558687432516,-0.2098973340555908,-1.6988640841726104,0.607600575846084,-0.11779828926796246,0.69916033364416674,0.26964864171659786,0.49428705537941076,-1.4831210225158986,-1.0202643856829652,-0.44699501074452752,0.10965859132760263,1.1287364520282828,-0.28996304080002794,1.2615507181411483,0.47542481170727136,1.174116751493715,0.12694706804364592,-0.65681592894808249,-1.48139907157878,0.15548899590389398,0.81855136852100052,-0.292588130834394,-0.54078641648852577,-0.30864181528011309,-1.0965933015254721,-0.49300981531645061,-0.18073935641503747,0.04584110571370504,-0.063783120022332648,0.611335194065236,0.10931769377487034,1.8140154502803756,0.31202382832927361,1.8044937717241869,-0.72312147957041806,0.526547037749559,-0.26025086170611678,0.60014250880863,0.59393079564875273,-2.1860216127482355,-1.327043149520291,-1.4410135976389145,0.40184449703981495,1.4702012808485194,-0.32681422878590616,0.812323004640796,0.54554010352611582,-1.0516323095208484,0.39746699579530864,-0.75189473868189161,1.5162668966459527,-0.032566509194480744,1.6359996572782924,-0.42505849061003081,0.58943336671822066,-0.062791225718324961,-2.0219589300517895,-0.98213152577904783,0.61251129816694927,-0.054886129988677361,-1.118732002452725,-0.62637853886713868,0.24951774056279513,-0.99301900654960062,0.97495022481131155,-0.64070950672605753,1.8088626205192539,-1.0798662507388281,0.19918944407526445,-1.5210265617689547,-0.72363112528907281,-0.59325031501080361,0.40133633981880107,0.94213331923694243,0.30048596759573026,-0.37307065863100425,0.8154885080924984,0.79888699215671588,0.12020528195635537,0.57124762971447607,0.41279601031139185,-0.98696188335152191,0.7595683259147834,-0.65720129909835034,-0.60391848137616921,0.17694682232941125,-0.30750346986275057,-0.13182035291589358,0.59535767388410177,1.0468327843052319,-0.197958632611842,0.32767816390720073,-0.238301504589733,0.22959689322031379,0.43999790482262935,-0.61686592888922742,0.27483678691166619,0.60110203246829508,0.092307951238962266,1.7298413915723643,-0.60855744473831941,-0.73705977169780545,-1.7498793063876255,0.910482579647112,0.86708255294732539,-0.0798928390580371,0.89847598937714179,0.18370342309124904,0.2907901348844536,0.11294471702105123,0.43995218887243992,0.10166244370034115,2.7873352278134353,-1.1666650301946411,-1.8542990826896939,-1.1406811446696323,-1.0933434562396045,-0.4336092964748236,-0.16846987827544835,-0.21853356002658053,0.54133443571937612,0.38926620384326388,0.75122898468833288,1.7782558992910045,1.223062551733807,-1.2832561046047666,-2.3289545162833418,0.90193146695171444,-1.8356386837351923,0.066756911436865754,0.035479485837577006,2.2271680781678715,-0.069214254022048366,-0.50732306461449839,0.23580967257624405,0.24580485189384324,0.0700452094168079,-0.60858051007994929,-1.2225933801866296,0.3165003607977161,-1.3428692366219301,-1.0321843440721712,1.3312158850649733,-0.41890319502984885,-0.14032172205636606,0.89982232889722347,-0.30011100561567589,1.0293657121030992,-0.345065971567321,1.0128018642629801,0.62933458493141881,-0.2130150826410547,-0.86569730836052372,-1.0431083013376268,-0.27006881264809884,-0.43814135560214368,-0.40867431479632566,0.98354523520555626,-0.297697144009373,1.1436789107709575,-0.53162011750706928,0.97256572800865315,-0.52225048499354887,0.17657779464231632,0.97073782355468852,-0.41397227497423017,-0.43827051820490154,2.0033906108622648,0.95099349954908541,-0.43200384372778045,0.64894073736358671,-0.3600763011539716,0.70588501934941583,1.4158490684365854,-1.6045156685970614,1.0288530690020257,1.4579677806619855,0.047471323274828531,1.7462567101184205,0.15538751420118108,-1.2371196846626296,-2.1934942788346068,-0.33340706726373348,0.713543302564059,0.31740773323449695,0.41361039029312963,-0.5770855836379396,0.14400180140446475,-1.6386657299338871,-0.76008999863526727,-0.81879309625025687,0.51972888813361928,-0.014160059097204691,-1.155529368287241,-0.0095249160981655586,-0.68981053763170952,-0.66669915360116438,0.86414942116512639,0.11341943622686775,0.39836284616599427,0.88396989023467065,0.18025769398704677,0.5508545220574701,0.68296427611193711,1.170608660035604,0.47586058727834257,1.4122326864445038,0.022608484309598147,-0.047869410220205889,1.701334654274959,-0.50971171276742655,-0.0028549601443212066,0.91986707980639548,0.14980873263276118,1.4049334456769766,1.03412153956971,0.29157028877080571,-0.7776985383116034,0.56669609753930472,-1.3826211594803521,0.24447467558988775,0.80843880316769123,0.21304169841700046,0.87967716423348885,2.0388762514140422,0.92393244868893687,0.266917446595828,0.64166150642177933,0.42548535562529555,-1.3147235034868836,-0.41641121969943384,1.2246878247853368,-0.04358420554633264,0.58242327744796918,-1.0065000746193355,0.064516742311104408,0.60029194918578355,-1.3615149548645669,0.34759263196006451,-0.18184321845933357,-0.93953476594149155,-0.037533188819171594,-1.8963044936224498,-2.1279767681826738,-1.1769233307149576,-0.990532220484176,-1.173032327267405,-1.7254277895286918,0.28822808966501057,-1.5941837202668065,0.1102188492233812,0.78706667635798022,-0.0022267863138361347,0.09310876005880353,-0.37815705658975751,-1.4826761110590034,-0.0438185853582948,0.96082521168211465,1.7382449326133405,-0.43020624242610045,-1.6273227364697802,0.16634749246006553,0.37626591045071883,-0.22695046470623254,-1.14891228961879,2.02433259954387,-2.3595235109584913,-0.509972045799939,-1.3216255908101016,-0.63612824966004144,0.31785141905969672,0.13804797444952585,-0.710735074811226,0.7770035267197879,0.62239392417201289,0.64738088451604681,-0.42563168166035137,1.0485807605364414,0.6607070863671749,2.5087724731851058,1.0634596390410229,1.1569216533273936,0.052978827325612841,-1.2883860029402914,-0.37122124749763225,-0.75779191649881861,-0.5639689170274268,0.55513856000184636,-0.55677806395036566,-0.89511313548243565,-0.40932772163407039,-0.16088676673844288,0.40933443045545531,-0.95263599711997748,0.31731747232461188,0.078020080978077527,1.3243854491602236,-0.21317048642158593,-0.13447864455542641,-1.1713558179202961,-1.3852626831952397,0.31050831860049871,-0.2494890644739389,0.50374405573732817,-0.89266140347703793,1.9085123303582223,0.12223070050488674,1.0470332668979343,-0.22692019932393689,-0.162501941548495,0.6900518978578063,0.555756771412105,-1.1202550014884105,-1.5326930139295092,-1.0978677695406691,-1.41577332156794,0.05957058856604576,-0.4112509255322197,-0.36801073304095522,-1.3609631293936939,0.77956742873497242,0.43941111155371204,-0.089622483741209721,1.021180118014184,-0.87397946502890322,0.41470029304762746,0.34844119995228134,0.34925441666371376,-0.72924726762950343,0.32684024876299139,-0.5148816329264756,-0.89644615050248611,-1.203268186415017,1.0378156394852396,-0.84594421233611783,-0.1729138442591677,-1.2086520547401993,-0.29712679999540437,-3.2320377959400068,-1.0869592294613304,-1.4264361594797232,-1.0144507677053212,-0.21326718830735794,-0.32534778036049111,1.9443977919662847,-0.57177321834945638,-0.25003227803504391,-1.5693154703406971,-0.47738266369406662,-1.33797665356226,0.030299023788183093,0.853086767518578,0.40425346510936017,-0.70062021341820546,-1.630542892747249,1.4600131851426457,2.0500427329378668,0.12050059969938885,-0.98990160422118678,1.1977714743148768,-0.59265621816925362,-0.46980936322445449,0.88637737707269393,-1.3852198011108376,-1.95675395423192,0.42068370020125,0.40073799814696209,0.095142157864168658,0.49668439163653022,1.0822405961606953,0.97044778835457179,-0.56856957038960532,0.80997207331853838,0.17324737183208791,-0.50554256851537893,-1.1933057908902021,0.6469709388811502,-0.3536225992993407,0.046434526687823004,-0.79294750220180765,-1.5505144747795614,0.17158635526862767,-0.062139124804361762,1.1990278772919676,0.80170407032727742,1.0533045791495463,-0.748876752543159,-0.93632649711602045,-1.2690867728684903,0.4979806230467323,2.7890811276439234,0.72757203691572281,-0.77306410215223653,0.83663375447615318,-1.1283303100836017,-1.4244700914163815,0.7174423155073576,-0.7779055201853976,0.31598588070860434,1.4065351380767912,0.40112463573186391,0.92966028441965609,-1.6058022046207487,0.66153624412340928,2.1385022538285137,0.54113941341713145,-1.5408771818578846,-0.20314279482183387,-0.49996522177934294,0.38302391278082887,0.41203537811175045,0.40549255051643973,-0.3637807508810153,-0.59927204004194567,-0.58958899141803423,0.85354083406448122,-1.8530080714195953,-0.20730315964762472,0.27037820268991586,-0.65277101205892807,0.47722728500767325,-0.071319650027454023,-0.93830128826881709,0.16136353465063602,-0.26818288191338824,-0.40987264775674193,-0.71132271052613871,0.061445483584097474,-1.8461292360985946,-0.39833311947813155,-0.543548121612387,-0.91189850428865948,0.65269859099524052,-0.734271258590912,0.540633089814446,0.97584088458182816,-0.15687041472705096,0.27779932172337451,0.63951730311087318,-0.080978015060609587,0.5408701437639355,-1.2625648446279578,1.1104238406701596,-0.98956267906836348,-1.8288359342038434,1.3844985113542618,-0.062726794041255862,0.44892112001916956,-0.36325847246767157,-1.0205833931310206,-3.0729885392870653,0.62627899769913886,-0.28668453321122472,-0.19734290685091929,0.40560537264054852,-1.41934846053479,-0.72944523798278149,1.1473278415851282,0.59786463288148561,-1.2812812590925264,-2.2032642421698969,-0.57124631979109453,0.21399647871645708,0.94237693330238392,0.093725490666918362,-1.1223117215280423,0.30615781856822288,-1.1723348675532874,-0.96096656353766863,-0.65373501635802778,-1.2293936489991555,-0.27096512996331146,-0.89995006734281313,-0.28568613760183359,-0.46242154435374688,-0.40978521474016538,-0.50353898413187337,1.2332971126441352,0.61030521757394984,0.059072155052654444,-1.4669467304282473,-1.6258032663962336,-1.964752415390894,2.6051957508739156,0.97237481120357716,0.25698096970425988,-0.97424045934694714,-1.1463643858874164,0.54763950448046483,1.5650839850824276,-1.6933436613208133,-0.44939735986025031,-0.084292072753420808,-1.9919971776032692,0.84124566635258113,-0.4146589174554855,1.912180838363861,-0.39089873223377219,0.40918208254735494,-1.1424281681214448,-0.62486377563672846,-1.168722849914551,0.39257528129753555,1.3018395043496134,-0.59364176184039552,0.43637539156213184,-0.50436248052580979,0.10210771330341752,1.1962505408223658,0.12028281636165018,-1.0368433970767554,-0.85710323888773809,-0.16987430404405768,-0.19166828004630485,-0.8658152077399367,0.18066413358618644,1.2665284755726489,-0.25116928743837841,-0.20457005066313635,-2.2015219060362714,-0.77451310476074919,-1.3932725840551512,-0.38623465098364451,0.52558635011786514,1.5232692753905963,1.7984944519082564,-0.11688426696978689,-0.32019618688563012,0.81751628323721526,0.49015918882398174,0.76525116001563476,0.7782790453113172,-1.480305173418627,0.540363959609767,-0.091539021868246917,-0.76025237695856762,-0.69359544314350152,1.2814577526633602,-0.80973761076575157,-1.236818352822848,0.2146864481317789,2.0107717675336114,0.025554433412308751,0.30829943624685913,-0.93824721062777927,1.6742159517791311,0.12498817384502289,0.53010125655069462,-0.95206822340148733,0.85404281822047756,0.38914573451776413,-1.1560010849517042,0.039740126989248378,-0.45059860370758742,0.10924794166566452,-0.25055284244615383,-0.18990165464867642,-1.0329135143008361,-0.32329192141939839,0.76652685410544719,1.7446731796690473,-1.1605199261697936,2.3774118523841707,1.5260779625070742,0.16850750021745609,-0.3012065293236989,-0.69865427070520736,0.83277057577802527,-0.69460525422280373,-0.46188299313412462,0.88361713672082753,0.43594418216372527,0.89674736305446345,0.50473202794489214,-0.40089713551584072,-0.5138480120992136,0.79636759623390141,-0.671190164007305,1.1866590428663819,0.79070197070358716,0.28772149467366837,0.0032261145630868519,0.36561718747292177,3.5266778183388507,-0.11243666251202412,-1.5565939349382756,1.9151022954567745,0.60984605323831043,-0.64791162309164485,2.6173349120507274,0.55095042074541234,0.29420368444669753,-0.77784379825338756,-1.0649300960900396,-1.768414032311056,-0.42291953589842968,-1.0531024291901772,0.64775524497172865,-0.31762818851351249,1.7689915691865741,1.5105823951927619,0.16401031690744336,-0.28276371450520832,1.1521658079483854,-1.1465076321167031,0.6736986965417775,-0.66911299537273594,-0.4003227006346633,-0.67180242721905792,0.57562901658315047,-0.77809351542081351,-1.0635612028846657,0.55297830128699788,-0.42342883783648705,0.36158716484805548,-0.3518892419461056,0.26954070797306312,-2.5644493561210866,0.465864128078826,1.8535609424938477,1.0392893398472121,0.91089657945849822,-0.23973128660132878,0.18099807979244104,0.24424954681334698,0.096392884539717685,-0.83046849761926067,-0.35225218566226318,-0.17477503954409865]
`
	// signal filtered in Matlab using FIR filter
	jsonFilteredSignalDffir = `
[0.0037496222085072286,0.027789723021354504,0.069162144783030677,0.1106143884340311,0.12402680059919458,0.0920797925588448,0.02346972429978518,-0.054153462252922613,-0.087238901627597065,-0.013739564798479362,0.17778863580000162,0.43578781504438946,0.64985812092228779,0.73968625642331409,0.69488954916199452,0.57097768229605106,0.4275477439251914,0.2997606639455242,0.21860298538825967,0.21477140368994196,0.29232717620287507,0.39892088301102285,0.44726330212545495,0.4067508969500499,0.31906034881455264,0.26165618108588651,0.27809015621169553,0.33706029689184958,0.37044147358197965,0.33267402553461806,0.23700897615702224,0.12287278305591776,0.020761308040293917,-0.072122828645125869,-0.184132466893964,-0.31289707765305774,-0.4178422241445105,-0.44153001736895942,-0.35372570318801938,-0.2037072128352598,-0.073994595427094412,-0.028814874425326469,-0.057646274794205921,-0.10102346444279035,-0.11224279310123871,-0.08514136533516764,-0.05801759015574795,-0.050150866066021121,-0.04228084881113648,0.00056782605153068446,0.090032118488626314,0.18349568003461356,0.21482708560325617,0.14499120326342282,-0.0035985493554218464,-0.14907891037446794,-0.21640792147934546,-0.17863610773519387,-0.079449073584918234,0.018127172929309279,0.068814255165480523,0.072819874897301864,0.050794578871206,0.034956951470184204,0.056793487563727769,0.13047729218017021,0.22295988701912714,0.26658170580995622,0.19579053123579823,0.039711876352924433,-0.10571180223116206,-0.14105692204367029,-0.061941941093375807,0.06075517271806969,0.14295745328410397,0.14264944142517885,0.060653164234869585,-0.07166197516833904,-0.20858471915231713,-0.29132936246085872,-0.28049880075378536,-0.17514895921327039,-0.026556221021769858,0.11530090487901952,0.21262470926281493,0.25893140345028687,0.26290393142991775,0.24118963726614709,0.21015888402071298,0.1711438723855129,0.10632914696987361,0.0030725852395515254,-0.11123631437478732,-0.16453410867828688,-0.10732662258320197,0.046360896027719464,0.20364446787633714,0.25859556712844561,0.17384554434870036,-0.015030342939671622,-0.21619925686067684,-0.35254459903292745,-0.38929913421171547,-0.34173560135592013,-0.25629790804980446,-0.17632718405520775,-0.12328583918630269,-0.085504105938954619,-0.026964823459721975,0.06520079484164229,0.16037426077351208,0.18744808848988329,0.11369071123119111,-0.029970042808954038,-0.14810951469113462,-0.16985741897686785,-0.088235610620491456,0.026003482316867495,0.096293108321013135,0.075679580822034756,-0.0037525613193511321,-0.061368845313007396,-0.016121727400335534,0.1295611738527376,0.2863707294694593,0.33501464900219885,0.2504539840970002,0.10599535987626309,0.013318311835565859,-0.003523000861001325,0.0048028657593302618,-0.037461728050963615,-0.14669369701357191,-0.27766670110742386,-0.35948691499121754,-0.35235387548758945,-0.2734175305442082,-0.17245457139201725,-0.0896777957417443,-0.038324325534730835,-0.001957175112190632,0.024320033090427112,0.021380827218625761,-0.030672191800945259,-0.13170925941311162,-0.24723106189688063,-0.34235631789919951,-0.39955784015332263,-0.43547338579871875,-0.45545977621126016,-0.44532447520125085,-0.38023896958440079,-0.25704254477438349,-0.11670341763861081,-0.015319795713249863,0.023458162290723745,0.017022460211892271,0.0074125073350423442,0.015789222094030209,0.037956594659851572,0.04743380910648886,0.023674770775673776,-0.04221111497439891,-0.11977451628043043,-0.1430400000356277,-0.060351990730124538,0.10517491096083262,0.24903924763944418,0.26256999817175158,0.14115652604873388,-0.027575236646167362,-0.15795303218066703,-0.24459582318801462,-0.32990934898527696,-0.42296057064613857,-0.45988220506504179,-0.3844242426232144,-0.21767388368409915,-0.050942592393595179,0.044809632586683523,0.055818569714866095,0.022335010993395726,-0.022990638998044096,-0.068915774790301337,-0.10897843383169221,-0.12090941417333953,-0.092575084989438908,-0.027137489796600273,0.050473774173577887,0.11726110428227152,0.15648975434086923,0.16420070153123484,0.13296611782222326,0.071011658600044963,0.00095806168488514216,-0.041547240381198995,-0.025717811859966057,0.056135156727796,0.1696403553315827,0.26631225157897104,0.3052976790129599,0.27176359226197305,0.19170548436821871,0.10938162722896126,0.060707611152585647,0.0580556751523491,0.088351688627832811,0.11832466809096878,0.116644489035771,0.070602613878214177,-0.0065250143352764238,-0.070237314458899552,-0.085301191803316551,-0.054656975586023442,-0.017912648847989217,-0.02696658096098796,-0.098879836655229467,-0.20070662172629439,-0.26277795954686245,-0.2396848414100653,-0.1456641893073162,-0.031275905972873705,0.057754337658735277,0.1202260565380235,0.16022328151646731,0.16259237563898191,0.10189350798353577,-0.013444063491809131,-0.1243246637917868,-0.16795711308676023,-0.1276308620096511,-0.051166645490309644,-0.0087166054916633477,-0.037610273747041553,-0.12825541077318817,-0.23541165975964076,-0.30669339229784881,-0.33088938570506005,-0.33936700328339209,-0.3603534185569145,-0.38632306155105117,-0.36881096472544023,-0.27603998523678241,-0.13290669750245848,0.0018701403270258037,0.0715343053038547,0.059459694525578664,-0.00313692380985112,-0.054406994474238843,-0.0482761339931256,0.0095844892292675128,0.070285161149993933,0.078699302879093866,0.037500446959154526,-0.0073257701373453292,-0.021224956644702711,0.0046260019485999723,0.037977552947683527,0.064798928915383039,0.090433667118259328,0.13044429743431979,0.17653120829186061,0.19325227428097491,0.14349916825072875,0.032144147364387976,-0.096797017399906843,-0.18504461982948697,-0.22196680254388163,-0.22296451678957305,-0.215774223858164,-0.18918095231814169,-0.121254252376179,-0.0035780620820289612,0.12863527303302194,0.22659675942684046,0.2460051875138087,0.17507255630137722,0.042061613964640379,-0.088396407182025072,-0.15774960807811925,-0.14075084233031904,-0.055582245469355175,0.053647573481966457,0.1532033446035973,0.23510571546010184,0.29913668210637662,0.33543464863168182,0.3192095148872357,0.241794033488112,0.12386261021689163,0.00752822793613488,-0.09002884500885501,-0.16589384787069131,-0.2136066487501582,-0.21049438459878453,-0.14075706998049539,-0.048815317191345242,-0.0073391212202227833,-0.068271433380867136,-0.22252018135984239,-0.40033972910177595,-0.53988250592221387,-0.59291783878405369,-0.54384228958518266,-0.39815238959909455,-0.19978479582274133,-0.017515876307332721,0.0964444307053946,0.13178695752528385,0.130367815947258,0.1415522543112975,0.17891422756815359,0.22165221254872608,0.237315146894546,0.20231764656251611,0.11636356813255341,-0.010196966993236843,-0.15768589413015643,-0.28227826369030479,-0.33011711680770128,-0.27907329653160312,-0.16741958462306231,-0.068317894742594421,-0.033663591382594664,-0.05576877539740397,-0.078555924497174745,-0.071620127653196308,-0.044174726791583838,-0.045300695898904508,-0.0967371033478831,-0.17731865347733478,-0.24144937906907249,-0.26518023677825536,-0.26768132931125993,-0.27766654385601874,-0.30461322260678025,-0.309787134153906,-0.23914225728035582,-0.099456527931708089,0.047282579827370247,0.10423791023045614,0.038059271840737451,-0.099373423478582745,-0.20860158587958111,-0.21956883663890658,-0.13286196335243389,-0.0027837702974588003,0.10936418484006867,0.17326494022658961,0.19310361743783172,0.1869287125046559,0.183508393766378,0.18579341275943742,0.16447027709033635,0.099839621648625268,0.0062888843641166793,-0.070083211625357869,-0.083806245502731774,-0.037359382011388095,0.022849286141034656,0.047047302894104692,0.015125404898211323,-0.040522851797401782,-0.0748936452887308,-0.055283839314184374,0.0050109808798688826,0.072510875465706073,0.10250357448468427,0.074272921273547468,-3.1860455897902854E-5,-0.09432469145568799,-0.17929253772993392,-0.23684295712829831,-0.26323576510655994,-0.25581833199940224,-0.22574927752331728,-0.18570153108765353,-0.14998839077214882,-0.13736202397285224,-0.14659837038512988,-0.14326561897224593,-0.076747071278367843,0.064634701160554017,0.23601837385394314,0.34494383418228214,0.34116485534215368,0.2622337466268132,0.2009162513312249,0.20746982000480882,0.25390343980664115,0.2608266940429157,0.18918498356916272,0.066124302170835175,-0.057899781563179771,-0.15914975617908589,-0.23526944729723476,-0.30165619523812276,-0.34898976207399424,-0.36173935191165835,-0.32096752909838761,-0.22787926369300665,-0.099881193975609336,0.015890679688396164,0.065277144818377222,0.019891379529907036,-0.093813406039653352,-0.19968208070095486,-0.22344021016936352,-0.14505874771121707,-0.0027627954970547031,0.14311790615512388,0.25157889905818986,0.30345610171162185,0.28467496991370489,0.1883693756109634,0.044862815531307464,-0.07980824683532721,-0.13207385246913494,-0.11234561513992394,-0.081963612592569846,-0.095340162785926635,-0.15799203170120443,-0.22471556096332476,-0.24852487287402367,-0.21131795578563942,-0.13139764634509846,-0.028339580070897548,0.08389835607553911,0.20276089557732266,0.31002758141270764,0.37885057015179779,0.37938836859442504,0.31396893071152665,0.22180025609744797,0.13682417235267935,0.054916257832260132,-0.058753772675646111,-0.21545280760649604,-0.35235440544390068,-0.38724804038761845,-0.28004420761495596,-0.086152004495367224,0.088830422538857742,0.16957284476377121,0.14600091654358038,0.075839891332828729,0.020811137938760327,0.028903303107525959,0.097812559436698268,0.18829581238799045,0.25002996647588926,0.23743641420596076,0.13731613398849879,-0.019036265391439103,-0.17315791863991559,-0.26377348661697192,-0.27757505813100564,-0.24290324640490751,-0.21338888745948786,-0.20064020378724706,-0.18813422633048379,-0.14161383515822504,-0.06031568383186639,0.025317193157613053,0.06719449737968794,0.035688075574061236,-0.065119374611879027,-0.18827386790858916,-0.2635408814507173,-0.23927564630437928,-0.13072463155122974,0.0068756450459049739,0.11135901881696551,0.16727626358897296,0.1907010697086812,0.20760475005567317,0.21324574096454721,0.19386287838250049,0.14124540883504116,0.066487748244444422,-0.0086085307518235232,-0.0675513676779075,-0.10356094733804148,-0.11062223361100788,-0.080408458419403889,-0.015928347833994657,0.065434001397745856,0.13278345517594287,0.15644324299962445,0.13801964416951373,0.09804382090386482,0.060873357898822415,0.041001626161929705,0.039138656138269896,0.062845897941063378,0.11154660012223812,0.16507970376200834,0.17013647569191939,0.096502553502068572,-0.025416544187969143,-0.11704900418357493,-0.11070155229622573,-0.013652460208846782,0.10752498366317984,0.18704387818441737,0.20328830948523036,0.1823887207998032,0.17178246831533045,0.19610920414245978,0.22957195386823517,0.21013170824885222,0.086438501648858745,-0.1257921213204308,-0.33488764044342451,-0.44432777150299535,-0.41910134945862049,-0.29935561460938903,-0.14593600987565566,0.0039494317089402986,0.15255569076727463,0.28535464014363204,0.34758575957787041,0.29155717918326768,0.11384920694386384,-0.11114288391621177,-0.28066237286833867,-0.31854360998514569,-0.22144941285545913,-0.0512432442965201,0.10482494852449448,0.18290642492667991,0.17359188585774527,0.11361257166904436,0.037914983124351841,-0.030838907514816688,-0.10466180908701514,-0.18731450377628442,-0.25693492865810108,-0.28002570383158815,-0.24325285845565739,-0.15964732925727396,-0.061765915566418611,0.02441434866655845,0.0840550255864064,0.12389269729548179,0.15440063005282453,0.18206924456812221,0.19341645872081556,0.15938742176124529,0.068514156858806158,-0.061978850836377115,-0.18669308343817614,-0.24901889594615528,-0.23120212154494021,-0.145261291985088,-0.0352849489103062,0.0630727832000044,0.12459638355365642,0.14264255712890028,0.13167163848660787,0.11210120016656638,0.096265423109576059,0.093606351593286272,0.11165220962714661,0.15801122624684991,0.2203030861647659,0.26618756544138,0.26372125015843351,0.22525333687628271,0.1807961354660145,0.156471978437561,0.15595037639768558,0.16956959390603632,0.20207789108486432,0.26024632953185356,0.31810518307283087,0.30786163201676919,0.1840636350890705,-0.023995567220850337,-0.21585141862052368,-0.28472178161881656,-0.21571733946936519,-0.0815676488697951,0.011373351915065444,-0.00062477985173223574,-0.10272817437554899,-0.22730520806453547,-0.30392801383875834,-0.30545652341885521,-0.25162455678347512,-0.192922760951231,-0.17220190664355528,-0.18366823494872694,-0.19031505705413146,-0.15273285721567062,-0.066495289712621919,0.04246252743256973,0.13923578705958353,0.2044776980222881,0.24429597078293694,0.27342802083993684,0.31024854788603889,0.35309399320082541,0.37953398539661665,0.37717460233249084,0.34479118308055973,0.2956217187943031,0.24738531531048272,0.20756667191756334,0.18772181688526141,0.20116296169982437,0.25201835676825046,0.308952391335214,0.32828589450502871,0.27436296555232315,0.15532338623589945,0.0271646017330932,-0.050876563897622087,-0.046937578045442144,0.039472205255212459,0.17774081597346644,0.32515206091553545,0.43667820902834292,0.48068549644972808,0.4388526727705423,0.32403785281149744,0.17518797425335711,0.046605828847511847,-0.013085538792541849,-0.0026584939367478929,0.035567031741824184,0.054511644510327049,0.030359952291530677,-0.019377894370975667,-0.065561403556529743,-0.096177591984228469,-0.11842614053631614,-0.15239901409164,-0.216624688454155,-0.32568290729042537,-0.465671258634174,-0.59605434884009134,-0.67619977733587133,-0.68328308834398344,-0.639007129593558,-0.56922455240709624,-0.481818718311537,-0.37235303051314178,-0.23833928916021524,-0.1048219417137269,-0.020044272812001489,-0.015259755095031198,-0.0729022265791432,-0.11945397072149626,-0.09087807323766138,0.0087226536785156763,0.0992996672002282,0.10567048888115518,0.030555593213053182,-0.0638958734386491,-0.10744637568566308,-0.097731805376666814,-0.081241561860234,-0.10835419424159921,-0.1908281899247137,-0.29182057351400853,-0.35347580610964813,-0.34135891972536259,-0.25902920021726189,-0.14513131705738105,-0.032544685170688654,0.056568961711914535,0.12793560606819016,0.17768437871597992,0.22368458697726948,0.2924119776856563,0.39953057670274489,0.51676410586830457,0.57409929273989979,0.510106263932067,0.32584740856646216,0.08610093889017946,-0.11562101677508058,-0.22233390691009,-0.23480535591602944,-0.20487403601717435,-0.18264546187903311,-0.1822795905120298,-0.18650412314064096,-0.171218185454724,-0.13634895474817743,-0.085914810522913762,-0.023586964761273897,0.044887172104585232,0.094279275844905516,0.0811683311507601,-0.010688392298227489,-0.14282961632427263,-0.2399841348635971,-0.2528438034095925,-0.1834493429285437,-0.071062318535093164,0.048317934217642355,0.15379827520444223,0.22450497559200069,0.24466276510291654,0.218874928900379,0.16655429578620137,0.10233724014057148,0.011089182564207314,-0.12544871573733463,-0.29218877459206982,-0.42604849343535478,-0.47169263598848155,-0.42978236955897064,-0.34683013714757172,-0.2671815839782411,-0.19728806369017776,-0.11470027691753368,-0.0197012898542756,0.060835828606976894,0.10008108870061279,0.0987872937319641,0.080516651954395016,0.063847974354285825,0.046539888561945186,0.010766159946300324,-0.054372842685630932,-0.13279585604400687,-0.199611102950588,-0.22564812007862114,-0.21616935814133567,-0.19838527166292561,-0.22152108246942517,-0.3111519831165524,-0.45753336820136259,-0.60936284167237831,-0.70458246504786015,-0.70261654380776717,-0.59413692335091062,-0.40484650875075523,-0.19286082715124023,-0.032419410169495955,0.016636597975956197,-0.053463887036775806,-0.19278523132920825,-0.30863810400430286,-0.32714745101258369,-0.24366803187826058,-0.12497551015883585,-0.049162980588957683,-0.02572692561391042,-0.0037916542053228969,0.0653035076078874,0.16671589615974558,0.23296065392077128,0.21372394346261075,0.13131529961759278,0.040695752432184262,-0.036703663521048625,-0.11435920848681516,-0.20044109673128141,-0.259735117842088,-0.24458343225225218,-0.14275364848851571,0.0082823901327321661,0.15153327251374607,0.2447811242493029,0.27318140235851024,0.24808406251702536,0.18081406262780131,0.086554720672170488,-0.011181517910632186,-0.083643477682454462,-0.11732389101620291,-0.12956395970776427,-0.15170326968910119,-0.19592045060569277,-0.23112275702851184,-0.2023554772486672,-0.084141357465077546,0.0822084989894194,0.20774979824855705,0.21819260525238526,0.10764213374840254,-0.035779197076620813,-0.091361902159775771,-0.0075803051660162865,0.16204655945249596,0.289290525858583,0.27911756720089803,0.14035204965883588,-0.039442370367529948,-0.167544057844221,-0.19451280928360565,-0.1253730049868968,0.0043259996095780283,0.13426698956442465,0.20763630240662068,0.20894262396113109,0.18357019213763537,0.17999256972783328,0.19534052885324374,0.18000452282539495,0.098398375623241136,-0.016621465571067445,-0.085519147931740536,-0.0707397951865648,-0.0063495557156576284,0.031873332316966166,0.010880603762970174,-0.052891955276569681,-0.1204362358088281,-0.170348630198502,-0.1974801226302578,-0.19947886938493936,-0.17306401495598231,-0.12877012639126387,-0.088701401330209831,-0.075035452783025633,-0.088134388046935311,-0.11633613995902448,-0.1405234377255708,-0.1678032826858688,-0.20871641550209466,-0.26369288285762793,-0.32143393188639635,-0.35349503767680351,-0.34114763329478692,-0.2839509305183453,-0.19218736187407848,-0.085376811132390984,0.017576295670079428,0.098496293715600175,0.14769807821545888,0.16443370553282163,0.15079415949506011,0.11876464588483984,0.070845343468640742,0.0057809692597768636,-0.069543137956767878,-0.13548864089033286,-0.15788606348794818,-0.12281529782970176,-0.058009958242616511,-0.035398623149847763,-0.10755299706388803,-0.25217115496597692,-0.38430099469612944,-0.41550645769529043,-0.33966832559783,-0.23349165096227131,-0.16556692161636752,-0.14381398784567967,-0.12750653770723352,-0.10422736442586372,-0.10885164565272111,-0.18115075766809696,-0.28241192200998749,-0.32386231702368251,-0.26030011676215709,-0.13286882099902089,-0.040313364831926136,-0.045088509269524221,-0.1309948070929568,-0.2431026417070897,-0.334281952968965,-0.3888388909146055,-0.40439528319311835,-0.38714665796788017,-0.34811666153038623,-0.30165762268412893,-0.252202094953324,-0.18549038424751241,-0.090485630426375849,0.010236422991084793,0.059958834687885987,-0.0025750107222179686,-0.15519719435627305,-0.29263655075056733,-0.29615603428636134,-0.15010342383985328,0.0344832090716114,0.12060401291704961,0.080336422419233888,-0.010165039581328784,-0.061289191511203163,-0.064149298337051963,-0.07765664367804,-0.14090226786670931,-0.22306206373817858,-0.25211626362688561,-0.19006772677013667,-0.058047517237510553,0.070610574456564254,0.12249942545572486,0.068963110832634886,-0.058467172500673507,-0.17696319311690781,-0.21101770253676125,-0.14894923074173402,-0.0397010381599987,0.042050596196993716,0.070177041029822959,0.067006487449349617,0.068867723418618063,0.071601181594354565,0.042446859188975034,-0.035403999076606532,-0.13618600137196532,-0.20752082522128742,-0.21538124359030536,-0.15965684517433248,-0.06918784422991045,-0.00012776962889111,-0.00498602454268403,-0.10822384348152027,-0.27418475754963184,-0.41694990680739474,-0.44810782243771113,-0.32766684060385726,-0.09465081358552,0.15312284570674092,0.31917451892066218,0.35823173102743344,0.30912803095116143,0.2490109162643234,0.22143095369885812,0.21018763945421592,0.17301036811749393,0.095117070814740842,-0.0021046766495217417,-0.0772277206412754,-0.11107573187768874,-0.11489695741381273,-0.11194601273330361,-0.10681004482264271,-0.0823455630483078,-0.012333278008684688,0.083467034237262261,0.16316621765263414,0.19133381250076764,0.18141916480481418,0.16326119363462047,0.15564267868190182,0.14596289884262073,0.11633352309674526,0.068546885150967574,0.014923810765700617,-0.039137471252264244,-0.084372599835375178,-0.1122528400422723,-0.12011279568626493,-0.12621477447838378,-0.13980725420639323,-0.13886371318441532,-0.093405917417120524,0.013200216602388182,0.15724043857535749,0.30030208408507725,0.40228389789478058,0.42903202177624516,0.36881798768056545,0.24211864210629844,0.098063695309741739,-0.0072633215587161633,-0.047254119842441392,-0.019105965515484553,0.0530970661558193,0.13918236241498769,0.19722926775499267,0.19650056364746538,0.13926307900868656,0.068179073161528547,0.037055720547232551,0.067576530029375692,0.13591482445322534,0.19869194016187164,0.24439824170880378,0.29176216672633593,0.34961081488225493,0.39707511820755576,0.39507620668989091,0.33749017851242818,0.27102286211404292,0.2530154152779242,0.29779396788213686,0.35563258743656218,0.35509624852649019,0.245097148033166,0.042273131913624716,-0.18980762364913251,-0.36772712238695066,-0.43120422463315772,-0.36544220250989595,-0.20268156766367362,0.010024507915129884,0.20745688232492143,0.3342188299953619,0.35583421899847945,0.29007890077594217,0.180841687358427,0.075624005772919708,-0.011150021059261517,-0.075799357456377461,-0.12189556584807822,-0.15061336425530572,-0.16430056202173238,-0.17022715834635777,-0.16774214581472294,-0.14594552776016284,-0.10571768749271249,-0.075227724786264952,-0.0868044171369806,-0.13157360834784232,-0.15151392678627307,-0.079860820407746932,0.0815837281938888,0.25128278444280006,0.33811293622598088,0.31083843360886737,0.21209065632751289,0.10032475012818626,0.00899149878935028]
`
	// signal filtered in Matlab using IIR filter
	jsonFilteredSignalDf2sos = `
[1.3240217576123698E-17,4.21557905751467E-16,6.5576779620803872E-15,6.683986765371294E-14,5.0464816041509E-13,3.0233496835156195E-12,1.5028167888367076E-11,6.39649942188188E-11,2.3870242886054473E-10,7.9550016356630068E-10,2.4026670951635248E-9,6.6565929840247011E-9,1.7087060454344372E-8,4.0983248581529395E-8,9.2511414284301943E-8,1.9775549155235823E-7,4.024866931168345E-7,7.8365463971692562E-7,1.4657945372756148E-6,2.6437757548132049E-6,4.6135989634456815E-6,7.8133087894618361E-6,1.2876551377418356E-5,2.0701884458129982E-5,3.2541633714797115E-5,5.0114847485731062E-5,7.5749664261627714E-5,0.00011256107498401818,0.0001646705098885927,0.00023747376601296986,0.00033796337079689237,0.00047511041413778813,0.00066030906629700671,0.00090788436312449919,0.0012356603670243267,0.0016655815473880006,0.0022243752789509103,0.0029442379060743329,0.0038635210985246233,0.0050273895097369837,0.0064884153534617729,0.0083070707656596084,0.010552075039758909,0.013300551320855834,0.016637946392303076,0.020657668018181669,0.025460397098583363,0.031153036775568962,0.037847267657469694,0.045657687501048663,0.054699524924592249,0.065085929861282338,0.07692485825932413,0.09031558466587826,0.10534489338311664,0.12208301636239653,0.14057940333889379,0.16085842627532615,0.18291513530633297,0.20671119635670951,0.23217115074741554,0.25917914372771073,0.28757627135737718,0.31715869297093036,0.34767664916292618,0.37883451256426121,0.41029198053448884,0.44166649537589681,0.47253694910027666,0.50244869669356851,0.53091986499538968,0.55744890471940267,0.58152329195296459,0.60262924400838092,0.62026227417695079,0.633938372236079,0.64320556394666861,0.64765557465154866,0.6469353007162193,0.64075777902780717,0.62891233994259121,0.61127363353174036,0.58780923300334553,0.55858554274105421,0.52377177113307583,0.48364176958537825,0.4385735878307731,0.38904665059906485,0.33563652040890257,0.27900727400581715,0.21990158400742005,0.15912866076913884,0.097550270495702016,0.036065102397213195,-0.024408191461071788,-0.082948916564790032,-0.13865281493561166,-0.19065067626217452,-0.23812664069410977,-0.28033575003508615,-0.31662031282724507,-0.34642466908282621,-0.36930797185379771,-0.38495464479971081,-0.3931822264895487,-0.39394637215509709,-0.3873428505576399,-0.37360644588461822,-0.35310675033966554,-0.32634091038886848,-0.29392346646722323,-0.25657350029997639,-0.21509937385194325,-0.17038140736340535,-0.12335289917484034,-0.074979935476112272,-0.026240472358010532,0.021896805513662614,0.068493336434986563,0.11266073494334394,0.15357955668645662,0.19051631634280139,0.22283834425491211,0.25002612312197997,0.27168281180657305,0.28754073725668039,0.29746471566994048,0.30145214806206722,0.29962992093679197,0.29224822731921607,0.27967150455707179,0.26236676066380155,0.24088962839846895,0.21586854382010995,0.18798749209208887,0.15796779657128465,0.12654944681101749,0.094472466559130108,0.062458814086634049,0.031195284597228933,0.0013178488049424893,-0.026602185835926044,-0.052069862826790728,-0.074675851565745521,-0.094103121240670551,-0.11013090319290178,-0.12263591115085075,-0.1315908682700723,-0.13706046670947641,-0.13919495721216482,-0.13822163069883497,-0.13443450931542628,-0.12818260910312163,-0.11985716923749876,-0.10987826277821347,-0.098681210676052539,-0.086703214436373216,-0.074370603805051741,-0.062087064999637967,-0.050223173593853865,-0.03910750572810489,-0.029019543660236818,-0.02018452876639994,-0.012770349036917169,-0.0068864810101267465,-0.0025849400434590592,0.00013687015932699982,0.0013315759026201776,0.0010957383388541329,-0.00043749316188394414,-0.0031066828207365702,-0.0067310449660785091,-0.011119681236139,-0.016080781767764153,-0.021430461772261059,-0.027000923374826711,-0.032647660733616413,-0.038255463270815721,-0.04374301611070943,-0.049065947095297387,-0.054218224444674321,-0.0592318665435624,-0.064174983698586069,-0.069148229235869246,-0.074279792234245079,-0.079719114824836582,-0.085629561755413419,-0.092180307396269867,-0.099537734329747413,-0.10785665713184509,-0.11727169420911385,-0.12788910918857066,-0.13977943129024731,-0.15297114159747155,-0.16744567977531871,-0.1831339844985074,-0.19991473186885789,-0.21761438093491825,-0.23600907580737496,-0.25482839170480276,-0.27376084959306868,-0.2924610629768245,-0.31055832292238517,-0.32766637550655642,-0.343394101402965,-0.35735677181560904,-0.36918752974102209,-0.37854873154194413,-0.38514278163058574,-0.38872210287764752,-0.38909790697100116,-0.38614746173663217,-0.37981959542056032,-0.37013822978923339,-0.35720379301641025,-0.34119242782460013,-0.32235297819775832,-0.30100180702730484,-0.27751556510343078,-0.25232209675639378,-0.22588972712591213,-0.19871522859337987,-0.17131080767821838,-0.14419048727918105,-0.117856281455457,-0.092784570262838956,-0.069413080128747487,-0.048128860885428892,-0.029257624274647554,-0.013054771238190044,0.00030161230308723384,0.010715567823903652,0.018175724805259051,0.022755318346948272,0.024609744459047476,0.023971706725345047,0.021144079978781705,0.016490685346541453,0.010425234425182749,0.0033987564868484779,-0.0041141302531515688,-0.011629705655217887,-0.018669970387867926,-0.0247773694316565,-0.029528982071154151,-0.032549757858317874,-0.033524404581471982,-0.032207572882861135,-0.028432031720972143,-0.022114587898612627,-0.013259569581944242,-0.0019597660608822727,0.011605208312582257,0.027173081411764048,0.044405502051327886,0.062896838986486764,0.082184943821468862,0.1017635644061432,0.12109604821341913,0.13962993949941771,0.15681205079269764,0.1721035790471887,0.18499483978772058,0.19501920849203525,0.20176588657505182,0.20489114856168919,0.2041277758999282,0.19929243963684751,0.19029085690106959,0.17712061270579804,0.15987160683922003,0.13872415338066263,0.11394482558487862,0.08588019956852265,0.054948704668947079,0.021630835035604305,-0.013541985235855774,-0.0499995631729534,-0.087145786322853,-0.1243718154535339,-0.16106927866696333,-0.19664313789849791,-0.23052392053633125,-0.26217903844091117,-0.29112295266332316,-0.31692598319346665,-0.3392216075699479,-0.35771213858959283,-0.372172718138265,-0.38245360988822441,-0.38848081696528514,-0.39025509054408247,-0.3878494307387092,-0.38140521138825079,-0.37112708488485124,-0.3572768417745687,-0.34016641241923784,-0.32015020469238509,-0.29761697283764654,-0.27298140875422028,-0.24667563873488685,-0.21914079680889262,-0.19081883113123677,-0.16214468312311206,-0.13353896109267421,-0.10540121157979387,-0.078103873315311309,-0.051986980999299479,-0.027353669496722625,-0.0044665138054527714,0.016455273578536357,0.035237778469043891,0.051753455298601314,0.065921342779070219,0.077706444336658742,0.087118300706783863,0.0942087897921983,0.0990691967157289,0.10182660524566785,0.10263967066631363,0.10169384382718266,0.099196126516329308,0.095369449299939818,0.09044677422992739,0.084665035872442729,0.078259044352271781,0.071455482843172213,0.064467138410887123,0.05748750858052161,0.050685925753758708,0.044203337054322014,0.038148867903587992,0.032597283397975914,0.027587442387060124,0.02312181530071495,0.019167108764564462,0.015656008636749191,0.012490019270487417,0.0095433417045318516,0.0066676983792575183,0.0036979782083366606,0.00045854475010813746,-0.003229976888812464,-0.0075436407395846165,-0.012648070343781733,-0.018691529687264678,-0.025798406772927357,-0.034063335228638761,-0.0435461647574477,-0.054267969009972224,-0.066208250154208337,-0.079303463871283536,-0.0934469478010451,-0.10849029189434785,-0.12424614216049217,-0.14049238150226215,-0.15697758433711384,-0.1734275971381791,-0.18955305645911319,-0.20505762088302726,-0.21964666494268426,-0.23303616247196429,-0.24496147489580838,-0.25518575719982034,-0.26350770099647669,-0.26976835016761236,-0.27385674964468254,-0.27571422131523005,-0.27533710185263188,-0.27277782423040453,-0.26814427634891025,-0.26159742493502341,-0.2533472489062889,-0.24364708187819228,-0.23278651658192512,-0.22108307284834672,-0.20887287381666561,-0.1965006106378924,-0.18430910289343477,-0.17262877925250314,-0.16176740988397853,-0.15200041850110024,-0.14356208769037465,-0.136637946754201,-0.13135859741398304,-0.12779519042256085,-0.12595671673994829,-0.12578922197761633,-0.12717699402673302,-0.12994571297833993,-0.13386749149204571,-0.13866767453908191,-0.1440332117353933,-0.14962236497514858,-0.15507547029839652,-0.16002643720316984,-0.16411464203589504,-0.16699685550257787,-0.16835883830123261,-0.16792624366227257,-0.16547448118557395,-0.16083722247618001,-0.15391326511298381,-0.14467151656532351,-0.13315391266521,-0.11947614476522929,-0.10382613415893269,-0.086460259915089183,-0.06769741502998658,-0.04791103367809145,-0.027519297236805691,-0.0069737865869913453,0.013253099056359588,0.03268159269584768,0.0508384821030105,0.067271085553055526,0.081560853327576621,0.093336172379165236,0.10228396991175231,0.10815974323141506,0.11079568729837982,0.1101066467515066,0.10609368415475665,0.098845128832954945,0.088535048613680334,0.075419167531570991,0.059828333392896116,0.042159717304600733,0.02286600015780894,0.0024428660898119861,-0.018584822147317721,-0.03967774814342119,-0.060297320079932951,-0.079920840577456867,-0.0980562068816464,-0.11425569560805343,-0.12812841619045884,-0.1393510604226853,-0.14767663045824395,-0.15294089234224412,-0.15506637428937736,-0.15406380596956026,-0.15003097438863372,-0.1431490509208273,-0.13367652012341547,-0.12194091178713816,-0.1083286011514896,-0.093272996559575078,-0.077241477614711548,-0.060721479079378193,-0.04420613566162282,-0.028179910182362697,-0.013104622496111742,0.000593720618146676,0.012536922816591439,0.022405089701365954,0.02994532901844205,0.034978429172233122,0.037403346573912685,0.037199397229400757,0.034426114988470383,0.029220806104465771,0.021793895288992775,0.012422220438949819,0.0014404899228323471,-0.010768833845015424,-0.023786919218398424,-0.037170880977831111,-0.050466667285522446,-0.06322214712187757,-0.075000027045468265,-0.0853902365430522,-0.094021441938983069,-0.10057137901195434,-0.10477573303911611,-0.10643534063270907,-0.1054215389425289,-0.10167954292257708,-0.095229788675359819,-0.0861672386413721,-0.074658700874453782,-0.060938268200491072,-0.045301032196115316,-0.028095270323478951,-0.0097133411125678373,0.00941844886143167,0.028850721885457484,0.048122353591544847,0.066771945317706735,0.084349149602324092,0.10042556685210266,0.11460495110663825,0.12653248888912449,0.13590294632990058,0.14246751493391507,0.14603922434762739,0.1464968300787462,0.14378712418699091,0.13792565642300492,0.12899589117381172,0.11714686102615798,0.10258941006788616,0.0855911486379983,0.066470265676599041,0.045588364822291769,0.023342505791024759,0.0001566432973360548,-0.023527338099998893,-0.047258793187241244,-0.070587491861785173,-0.0930726105533157,-0.11429135852489594,-0.1338470716460613,-0.15137662239131863,-0.1665570133192508,-0.17911104165908709,-0.18881194439655682,-0.19548695593851328,-0.19901973359363764,-0.19935162931087752,-0.19648180898155959,-0.19046624278976976,-0.18141561128309774,-0.16949219176098013,-0.15490580799442139,-0.13790894296664236,-0.11879112903120859,-0.097872742392472539,-0.075498338890581079,-0.052029675492015662,-0.027838566435863778,-0.0032997244889150339,0.021216263905328193,0.045349685692910945,0.068758034693621933,0.091121806880651843,0.11214964687787876,0.13158275170791017,0.14919845661219339,0.1648129482648038,0.17828307238525606,0.189507225045274,0.19842533925010711,0.20501800003330758,0.20930474171843319,0.21134159958449475,0.21121800438878086,0.20905312159047046,0.20499174731661424,0.19919987986762505,0.19186008874760804,0.18316680283351303,0.17332163550576474,0.16252885761451771,0.15099111942021465,0.13890551058020226,0.12646003336894579,0.11383054916202673,0.10117824232973113,0.088647629597876393,0.0763651271221521,0.064438172411789341,0.052954884188764664,0.041984230573283154,0.031576664873146768,0.021765178890956673,0.01256671616043081,0.0039838819429371293,-0.0039931168255929825,-0.011384370172251607,-0.01821807071286732,-0.024528292774649872,-0.030352807989742242,-0.035730995311547983,-0.0407018970769732,-0.045302465309661685,-0.049566034163928206,-0.053521045500086808,-0.057190045329849906,-0.060588959556473483,-0.063726648341700415,-0.066604729837056537,-0.069217656182013865,-0.071553017833941537,-0.073592046662482563,-0.075310283985748,-0.0766783769772619,-0.077662965712580509,-0.078227623580333611,-0.0783338158216365,-0.0779418444882838,-0.077011752962988761,-0.075504169140815,-0.073381073149807366,-0.070606482763036146,-0.067147057060712625,-0.06297262605571334,-0.058056660510397318,-0.052376701671999412,-0.04591477479446246,-0.038657812801312946,-0.030598117046450636,-0.021733880694698969,-0.012069796707346073,-0.001617766811486095,0.00960227971214166,0.021561457836853391,0.03422090022977739,0.04753065493476076,0.061428541934743813,0.075839015139306534,0.09067208752360241,0.10582238695886081,0.12116841808485698,0.13657211077227405,0.15187873775685357,0.16691728243568185,0.18150133225608014,0.19543056340350057,0.20849286858073823,0.22046716172715242,0.23112687190825665,0.24024411386098954,0.24759449553915031,0.25296249436198726,0.25614730475965003,0.25696903116965797,0.25527507407170774,0.25094653317804511,0.24390443271914902,0.23411555999478204,0.22159770097872422,0.20642405656362517,0.18872663056501124,0.1686983961467208,0.14659407085140896,0.12272936156146198,0.097478578793058851,0.071270563741824736,0.04458292017172822,0.017934595048590039,-0.0081230949402571039,-0.033016840994841964,-0.0561629233846742,-0.076979749207799847,-0.094901059179154479,-0.10938948283675848,-0.11995009735033818,-0.12614363086508762,-0.12759894778046793,-0.12402446095750233,-0.11521813459330195,-0.10107577103258715,-0.081597314350110653,-0.056890952015059754,-0.027174851885427655,0.0072235665605795037,0.045870862427180678,0.0882332736316897,0.13368478919905019,0.18151743177240526,0.23095352933476349,0.281159702574475,0.33126224997182185,0.38036357783114916,0.42755929806555426,0.4719556031001223,0.51268652493242806,0.548930693915922,0.57992723158002779,0.60499043980344358,0.62352298466598055,0.63502731585284422,0.63911510995981224,0.63551457676213763,0.62407551978076681,0.60477209469721371,0.57770325986138649,0.54309096102322663,0.50127613644665336,0.45271266793330223,0.39795943745512091,0.33767067778403431,0.27258482866109929,0.20351212781312145,0.131321178803156,0.056924745699463278,-0.018734971674811494,-0.094701328128564077,-0.1700182386567588,-0.24374495498638055,-0.3149703779522055,-0.38282668210409776,-0.4465020429792248,-0.50525227395329086,-0.55841119852964094,-0.60539960534726944,-0.6457326570630435,-0.67902565049113361,-0.70499805376319991,-0.723475776484649,-0.73439166045463766,-0.73778421091539959,-0.73379462081662683,-0.72266217245771824,-0.7047181312906271,-0.68037827480328361,-0.65013422445957514,-0.61454376991190718,-0.57422039148907966,-0.52982219878453707,-0.48204050966681483,-0.43158829501176432,-0.37918870990084474,-0.3255639221121619,-0.2714244338053512,-0.21745907289759242,-0.16432580743560055,-0.11264351011330628,-0.06298477189803936,-0.015869834506580315,0.02823831776444612,0.068937694608611044,0.10588987879783773,0.13882148557418372,0.16752456046400974,0.19185599018162153,0.21173601380971366,0.22714592990484939,0.23812509974948948,0.24476734801059041,0.24721686006965191,0.24566367086842017,0.24033883393694044,0.23150935201770556,0.21947294301971557,0.20455270750469606,0.18709175699468661,0.16744785643824103,0.14598812938431888,0.12308387084946679,0.099105510451582821,0.074417766930721191,0.049375034398027026,0.024317040198010533,-0.00043518624203549641,-0.024582995139604723,-0.047853411917137288,-0.070002012547045522,-0.090815348488595571,-0.11011289607728802,-0.12774851140703275,-0.14361137887314823,-0.15762644935497977,-0.16975437218289047,-0.17999093319314008,-0.18836601895818089,-0.19494213434462754,-0.19981250659985966,-0.20309881397191551,-0.20494858027905252,-0.20553227880852931,-0.20504018947530944,-0.20367905243745177,-0.20166855955571045,-0.1992377224808019,-0.19662115308776473,-0.19405528882187045,-0.1917745926540895,-0.19000775512948487,-0.18897392474800659,-0.18887899289053092,-0.1899119608423944,-0.19224141920308929,-0.19601217400515331,-0.20134205896606128,-0.20831897910831834,-0.21699823704365473,-0.22740019898829569,-0.2395083624758681,-0.25326789117656018,-0.26858468366507682,-0.28532504192820551,-0.3033160014937567,-0.32234637805605748,-0.3421685752771394,-0.36250118512090984,-0.38303239584746296,-0.40342420401829082,-0.42331740603189272,-0.44233732242458107,-0.46010018512237455,-0.47622009476913263,-0.49031643297273175,-0.5020215936038247,-0.51098887893165923,-0.51690039112626818,-0.5194747381668513,-0.51847436605518227,-0.51371232691656687,-0.50505829543195313,-0.49244365429707371,-0.47586548310926,-0.45538930413724643,-0.43115046255979012,-0.4033540475169981,-0.37227329308484913,-0.33824643427928391,-0.30167203150004529,-0.26300281639827261,-0.22273815187351217,-0.18141523760625453,-0.13959922903586228,-0.09787247086019224,-0.0568230748966649,-0.017033095551538854,0.020933426613449296,0.056542272285115255,0.0893004176384241,0.11876669554321818,0.14456147561859478,0.16637511404126504,0.18397494990064917,0.1972106570273208,0.20601779781235541,0.21041946764013286,0.21052596410840049,0.20653246304460665,0.198714732221207,0.18742296236793252,0.1730738423188653,0.1561410496900083,0.13714436919228612,0.11663768646765374,0.0951961352304867,0.07340269868336792,0.05183458200316212,0.031049680695318389,0.011573469532338978,-0.0061133714162432459,-0.021586293311289407,-0.034486900984459529,-0.044531415300122459,-0.051517366254952672,-0.055328349641385638,-0.055936726232528114,-0.05340419152551823,-0.047880194879036053,-0.039598238151340517,-0.028870134455806593,-0.01607835621501371,-0.0016666471974056893,0.013870885358177956,0.030001945993737761,0.04616921046452388,0.061804161919665639,0.0763412790853733,0.089232241680297586,0.099959815774742777,0.10805108687178389,0.11308972107695064,0.11472695463451393,0.11269103900652049,0.10679490208325326,0.096941825432460868,0.083128981976941629,0.065448727263418077,0.044087589555724935,0.019322958248007609,-0.0084824746486968534,-0.038888410210956494,-0.071386612375187314,-0.105412338199577,-0.14035726884206595,-0.17558364082206165,-0.21043924320231827,-0.24427292018682986,-0.27645020117610142,-0.30636867224188158,-0.33347270472761964,-0.35726716842783762,-0.37732977844036397,-0.39332175591454266,-0.40499652283826471,-0.41220619874314479,-0.41490572153836919,-0.41315447417663587,-0.40711536191054537,-0.39705134979826284,-0.3833195350832001,-0.36636289231545238,-0.346699888861381,-0.32491222312131524,-0.30163098585401621,-0.2775215851964199,-0.25326780720859582,-0.22955540527115331,-0.20705562290379423,-0.18640905534096538,-0.16821024556739106,-0.15299339083787675,-0.14121950660013455,-0.13326535706229709,-0.1294144164623775,-0.12985007364443479,-0.13465123620390734,-0.14379043071146197,-0.15713443390056239,-0.17444740776896522,-0.19539645083923673,-0.2195594198313118,-0.24643482211147094,-0.27545353076316736,-0.30599203209143833,-0.33738688076738765,-0.36895001139659211,-0.39998453760811631,-0.42980066115212456,-0.45773131409194351,-0.48314716689221981,-0.50547065373530009,-0.52418869323192308,-0.5388638171222353,-0.54914346070190934,-0.5547672155099912,-0.55557189609978119,-0.55149432719293534,-0.54257181382067476,-0.52894031376343764,-0.51083038726993457,-0.4885610522402376,-0.46253172241736107,-0.43321245035947076,-0.40113273490228074,-0.366869183480662,-0.33103234228029466,-0.29425302119510177,-0.25716844570020075,-0.22040856401922571,-0.18458282565813233,-0.15026772705728147,-0.11799539259263825,-0.088243425464328978,-0.0614262243468791,-0.03788791935938686,-0.017897036326928371,-0.0016429528324551691,0.010765835462972826,0.019301663087669639,0.024015923018979424,0.025035677173441483,0.022558783744000312,0.016847703378146003,0.00822216821614493,-0.0029490856861367851,-0.016257311041629783,-0.031263250010727765,-0.047506925272192954,-0.0645175081514149,-0.081823059061841674,-0.098959947944282117,-0.11548177813483479,-0.13096765561220314,-0.14502966631345321,-0.15731944660285863,-0.16753375547059243,-0.17541898107183967,-0.18077453825080203,-0.18345513720945006,-0.1833719259946274,-0.18049253055584463,-0.17484003540063614,-0.16649096505237343,-0.15557234139042181,-0.14225790440762226,-0.12676359392624245,-0.10934239742235508,-0.090278674440576134,-0.069882071310670507,-0.048481141216012685,-0.026416784341520512,-0.0040356210769439856,0.018316591713327633,0.040301395333165395,0.06159381365800997,0.08188819179160664,0.10090359983831948,0.11838871973826126,0.13412614094270481,0.1479359993365576,0.15967890330635448,0.16925810126190605,0.17662085627848448,0.18175900582493815,0.18470869771812815,0.18554930736765052,0.18440155584747414,0.18142486307991379,0.17681398509999083,0.1707949985845123,0.16362070914086319,0.15556557180292468,0.14692022234009161,0.13798572596360545,0.12906765550507032,0.12047011394130649,0.11248981616299519,0.10541034217164405,0.099496668598928723,0.094990077836866749,0.0921035344899819,0.091017607708556075,0.091877005656455651,0.094787775325388457,0.099815207519371535,0.10698247344162683,0.11627000620533125,0.12761562797987241,0.14091541153262208,0.15602525373281692,0.17276312820212611,0.19091197474524529,0.21022317447359984,0.23042055164182057]
`
)

func TestFilterFir_Filter(t *testing.T) {
	f, err := NewDffirFromJSON(jsonDffir)
	if err != nil {
		t.Fatal(err)
	}

	rawSignal, err := util.GetSignalFromJSON(jsonRawSignal)
	if err != nil {
		t.Fatal(err)
	}

	filteredSignal, err := util.GetSignalFromJSON(jsonFilteredSignalDffir)
	if err != nil {
		t.Fatal(err)
	}

	y, err := f.Filter(rawSignal)
	if err != nil {
		t.Fatal(err)
	}

	if !util.IsAlmostEqual(y, filteredSignal) {
		t.Fatal("filtered signal does not match reference signal")
	}
}

func TestSOSFilter_Filter(t *testing.T) {
	f, err := NewDf2sosFromJSON(jsonDf2sos)
	if err != nil {
		t.Fatal(err)
	}

	rawSignal, err := util.GetSignalFromJSON(jsonRawSignal)
	if err != nil {
		t.Fatal(err)
	}

	filteredSignal, err := util.GetSignalFromJSON(jsonFilteredSignalDf2sos)
	if err != nil {
		t.Fatal(err)
	}

	y, err := f.Filter(rawSignal)
	if err != nil {
		t.Fatal(err)
	}

	if !util.IsAlmostEqual(y, filteredSignal) {
		t.Fatal("filtered signal does not match reference signal")
	}
}
